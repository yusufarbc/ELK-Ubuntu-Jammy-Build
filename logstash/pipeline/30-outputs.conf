output {
  elasticsearch {
    hosts => ["https://elasticsearch:9200"]
    user => "elastic"
    password => "${ELASTIC_PASSWORD}"
    cacert => "/usr/share/logstash/config/certs/http_ca.crt"
    index => "logs-%{[event][dataset]}-%{+YYYY.MM.dd}"
    ilm_enabled => true
    ilm_policy => "logs-30d-delete"
    ssl => true
  }

  # fallback to stdout for debugging (disabled by default)
  if "debug_stdout" in [tags] {
    stdout { codec => rubydebug }
  }
}
