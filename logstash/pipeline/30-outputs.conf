/*
 Example outputs for Logstash. Place this file under logstash/pipeline/30-outputs.conf
 Ensure ELASTIC_PASSWORD is provided securely (env, secret, or file).
*/
output {
  elasticsearch {
    hosts => ["https://localhost:9200"]
    user => "elastic"
    password => "${ELASTIC_PASSWORD}"
    ssl => true
    cacert => "/etc/elasticsearch/certs/http_ca.crt"
    index => "logs-%{[event][dataset]}-%{+YYYY.MM.dd}"
    ilm_enabled => true
    ilm_policy => "logs-30d-delete"
  }

  # Optional: write to a file for debugging
  if [@metadata][debug] == "true" {
    file { path => "/var/log/logstash/debug.log" }
  }
}
